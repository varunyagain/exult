name: Deploy to GitHub Pages

on:
  push:
    branches: [ main ] # This runs the robot every time you push to 'main'

permissions:
  contents: write

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4 # 1. Robot grabs your code

      - uses: subosito/flutter-action@v2 # 2. Robot installs Flutter
        with:
          channel: 'stable'

      - name: Get packages
        run: flutter pub get # 3. Robot gets your app's tools

      - name: Build Web
        # 4. Robot builds the app and plugs in your secrets!
        # REPLACE 'your-repo-name' with your actual GitHub repo name
        run: |
          flutter build web --release --base-href "/your-repo-name/" \
          --dart-define=API_KEY=${{ secrets.FIREBASE_API_KEY }} \
          --dart-define=APP_ID=${{ secrets.FIREBASE_APP_ID }}

      - name: Deploy ðŸš€
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          folder: build/web # 5. Robot puts the build on the shelf
          branch: gh-pages # This is the special shelf name